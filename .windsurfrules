# Windsurf Rules: UnityVibeBridge Kernel

## üèõÔ∏è Architectural Authority
- **The Kernel**: `Assets/VibeBridge/` is the canonical source.
- **Protocol**: Bound by `AI_ENGINEERING_CONSTRAINTS.md`.

## üõ†Ô∏è Safe Tool Integration Checklist (CRITICAL)
1. **Canonical Source**: ONLY mutate `Assets/VibeBridge/`.
2. **Incrementalism**: Add only ONE method or payload at a time.
3. **The 20-Second Rule**: MUST wait 20s for Unity to recompile after every `.cs` edit before calling a tool.
4. **Syntax Pre-Flight**: Manually verify all braces `{}` and semicolons `;` before writing.
5. **No Duplication**: Always `grep` for existing `VibeTool_` prefixes to prevent Ambiguous Match errors.

## üîê Triple-Lock Protocol
- **State Proof**: Acquisition of `state_hash` from `engine/error/state` is mandatory.
- **Commit**: `transaction_commit` REQUIRES `rationale`, `state_hash`, and `monotonic_tick`.

## üõ°Ô∏è Asset Database Safety
- **NO DIRECT DISK MUTATION**: Never use shell commands on `.mat`, `.cs`, or `.meta` files while Unity is running.
- **Bridge-Only**: All mutations MUST go through the `VibeBridgeServer` API.

## üì¶ Git Isolation
- Snapshots go to `.git_safety`. Scene/Asset data NEVER goes to the main `.git` repo.
- **Snapshot Cmd**: `git --git-dir=.git_safety --work-tree=. add . && git --git-dir=.git_safety --work-tree=. commit -m "[Snapshot Name]"`
